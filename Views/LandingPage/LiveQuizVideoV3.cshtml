<style>


    /* CSS */
    .button-17 {
        border: 2px solid white;
        align-items: center;
        appearance: none;
        background-color: transparent;
        border-radius: 24px;
        /*border-style: none;*/
        box-shadow: rgba(0, 0, 0, .2) 0 3px 5px -1px,rgba(0, 0, 0, .14) 0 6px 10px 0,rgba(0, 0, 0, .12) 0 1px 18px 0;
        box-sizing: border-box;
        color: white;
        cursor: pointer;
        display: inline-flex;
        fill: currentcolor;
        font-family: "Google Sans",Roboto,Arial,sans-serif;
        font-size: 14px;
        font-weight: 500;
        height: 43px;
        justify-content: center;
        letter-spacing: .25px;
        line-height: normal;
        max-width: 100%;
        overflow: visible;
        padding: 2px 24px;
        position: relative;
        text-align: center;
        text-transform: none;
        transition: box-shadow 280ms cubic-bezier(.4, 0, .2, 1),opacity 15ms linear 30ms,transform 270ms cubic-bezier(0, 0, .2, 1) 0ms;
        user-select: none;
        -webkit-user-select: none;
        touch-action: manipulation;
        width: auto;
        will-change: transform,opacity;
        z-index: 0;
    }

        .button-17:hover {
            background: white;
            color: black;
        }

        .button-17:active {
            background: white;
            color: black;
        }

        .button-17:focus {
            background: white;
            color: black;
        }

    /*.button-17:not(:disabled) {
            box-shadow: rgba(60, 64, 67, .3) 0 1px 3px 0, rgba(60, 64, 67, .15) 0 4px 8px 3px;
        }

            .button-17:not(:disabled):hover {
                box-shadow: rgba(60, 64, 67, .3) 0 2px 3px 0, rgba(60, 64, 67, .15) 0 6px 10px 4px;
            }

            .button-17:not(:disabled):focus {
                box-shadow: rgba(60, 64, 67, .3) 0 1px 3px 0, rgba(60, 64, 67, .15) 0 4px 8px 3px;
            }

            .button-17:not(:disabled):active {
                box-shadow: rgba(60, 64, 67, .3) 0 4px 4px 0, rgba(60, 64, 67, .15) 0 8px 12px 6px;
            }

        .button-17:disabled {
            box-shadow: rgba(60, 64, 67, .3) 0 1px 3px 0, rgba(60, 64, 67, .15) 0 4px 8px 3px;
        }*/








    .card {
        box-shadow: 0 4px 16px 0 rgba(0,0,0,0.2);
        transition: 0.3s;
        width: 90%;
    }

    .swal2-radio {
        display: grid !important;
    }


    .modal {
        visibility: hidden;
        /*transition: all 0.4s;*/
        opacity: 0;
    }

        .modal.open {
            visibility: visible;
            opacity: 1;
        }

    .modal,
    .modal-overlay {
        position: fixed;
        left: 0;
        top: 0;
        height: 100vh;
        width: 100vw;
        z-index: 100;
    }

    .modal,
    .modal-card,
    .modal-body {
        display: flex;
        flex-direction: column;
        justify-content: center;
    }

    .modal-content {
        overflow: auto;
        flex-grow: 1;
    }

    .modal-overlay {
        background: rgba(0, 0, 0, 0.5);
    }

    .modal-body {
        z-index: 101;
        margin: auto;
        max-height: calc(100vh - 5rem);
        max-width: calc(100vw - 7rem);
        border-radius: 10px;
        overflow: hidden;
        width: 500px;
        height: 300px;
        background: white;
    }

    .modal-header,
    .modal-content,
    .modal-footer {
        padding: 1rem;
    }

    .modal-header {
        background: rebeccapurple;
        text-transform: capitalize;
        font-size: 1.25rem;
        color: white;
        font-weight: bold;
    }

    .modal-footer {
        display: flex;
        justify-content: space-between;
    }
</style>


@*<div id="QuestionOptions" class="modal close" style="z-index: 1031;">

        <div class="modal-card" style="height:30%">

            <div class="modal-body" style="overflow-y: scroll;">


                <div style="text-align:center;font-weight:bold;font-size: 19px;color: #e3007b;"><span>সঠিক অপশনটি সিলেক্ট করুন  </span></div>
                <br />
                <div class="form-group" onclick="OptionSelection(Option1)">
                    <input type="radio" id="Option1" name="QuizOptions" value="Option1">
                    <label for="Option1" id="optipon1label">HTML</label><br>
                </div>
                <div class="form-group" onclick="OptionSelection(Option2)">
                    <input type="radio" id="Option2" name="QuizOptions" value="Option2">
                    <label for="Option2" id="optipon2label">CSS</label><br>
                </div>
                <div class="form-group" onclick="OptionSelection(Option3)">
                    <input type="radio" id="Option3" name="QuizOptions" value="Option3">
                    <label for="Option3" id="optipon3label">JavaScript</label>
                </div>

            </div>
        </div>
    </div>*@




@*Video Section Start*@

<div id="LiveVideoDiv" style="width: 100%;height: 90vh;">
    <video id="LVideo" style="width: 100%;height: 88%;position: absolute;z-index: -1;background-color: black;" poster="~/Assets/LiveVideoThumbnail.jpg" muted>
        <source id="LSourceId" type="video/mp4">

    </video>
    <img src="~/Assets/icons8mute.png" style="position: absolute;top: 93vh;right: 3%;z-index: 3;" onclick="UnmuteVideo()" id="unmuteButton" />







    <div class="container card" id="QuestionOptions" style="position: absolute;top: 49vh;left: 5%;background: rgba(0, 0, 0, 0.73);">

        <div style=" text-align: center; ">
            <span class="dot" style="height: 70px;width: 70px;background-color: transparent;border-radius: 50%;display: inline-block;border: solid;border-color: white;position: relative;"></span>
            <span class="dot OptionAppearingTimer" id="OptionAppearingTimerId" style="color:white;font-size:xx-large;position: absolute;left: 48%;top: 6%;">5</span>
        </div>
        <br />

        <div style="text-align:center;font-weight:bold;font-size: 19px;color: white; margin-top:2%"><span>সঠিক অপশনটি সিলেক্ট করুন  </span></div>
        <br />
        <div class="" onclick="OptionSelection('Option1')">
            <button class="button-17" id="optipon1label" role="button">Button 17</button>
            @*<input type="radio" id="Option1" name="QuizOptions" value="Option1">
                <label for="Option1" id="optipon1label"></label><br>*@
        </div>
        <div style=" height: 6px; "></div>
        <div class="" onclick="OptionSelection('Option2')">
            <button class="button-17" id="optipon2label" role="button">Button 17</button>
            @*<input type="radio" id="Option2" name="QuizOptions" value="Option2">
                <label for="Option2" id="optipon2label"></label><br>*@
        </div>
        <div style=" height: 6px; "></div>
        <div class="" onclick="OptionSelection('Option3')">
            <button class="button-17" id="optipon3label" role="button">Button 17</button>
            @*<input type="radio" id="Option3" name="QuizOptions" value="Option3">
                <label for="Option3" id="optipon3label"></label>*@
        </div>
        @*<div style=" height: 6px; "></div>*@
        <div class="center" style="text-align: center;margin-bottom: 1%;">
            <button type="submit" class="btn btn-default" style="color: white; background: #e3126e; padding: 11px; border-radius: 16px;" onclick="SubmitAnswerOfLiveQuiz()">ওকে</button>
        </div>
    </div>

    <div id="RadioQuizId" hidden="hidden"></div> @*shouldn't be removed*@
    <div id="RadioQuizOptionId" hidden="hidden"></div> @*shouldn't be removed*@





</div>

@*<br />*@



@*Video Section End*@



@section Scripts{
    <script>

        var TimeTaken = 0;

        var LiveQuizResult = {};
        let count = 0;
        let VideoListCount = 0;
        var questionAppearingTimer = 0;

        $(document).ready(function () {

            $.get(window.location.origin + "/landingpage/GettingLiveQuizInformationV3", function (res) {
                
                console.log(res);
                LiveQuizResult = res;

                if (res.result != false) {

                        var ScheduledTime = res.result[0].scheduledDateTime.split("T")[1].trim().split(":");

                        var date = new Date();
                        var seconds = date.getSeconds();
                        var minutes = date.getMinutes();
                        var hour = date.getHours();

                        if (ScheduledTime[0] == hour && ScheduledTime[1] == minutes) {

                            var video = document.getElementById('LVideo');
                            var source = document.getElementById('LSourceId');

                            source.setAttribute('src', res.result[0].videoName);
                            
                            video.preload = 'metadata';
                            video.playsInline = true;
                            video.autoplay = true;
                            video.load();
                            //video.play();

                            if (ScheduledTime[2] <= seconds) {
                                var SD = new Date(res.result[0].scheduledDateTime)
                                var dateDiff = (date - SD) / 1000;
                                console.log(dateDiff);

                                if (video.duration > dateDiff) {
                                    video.currentTime = dateDiff;
                                } else {
                                    video.currentTime = 3;
                                }

                            }

                        } else {

                            //////////////
                            var video = document.getElementById('LVideo');
                            var source = document.getElementById('LSourceId');

                            source.setAttribute('src', res.result[0].videoName);
                            video.preload = 'metadata';
                            video.playsInline = true;
                            video.autoplay = true;
                            video.load();

                            if (ScheduledTime[2] <= seconds) {
                                var SD = new Date(res.result[0].scheduledDateTime)
                                var dateDiff = (date - SD) / 1000;
                                console.log(dateDiff);

                                if (video.duration > dateDiff) {
                                    video.currentTime = dateDiff;
                                } else {
                                    video.currentTime = 3;
                                }
                            }
                            //////////////////////
                        }
                    console.log(hour + ":" + minutes + ":" + seconds);

                        
                }

                let interval = setInterval(function () {

                    var LVideo = document.getElementById('LVideo');


                    if (VideoListCount > LiveQuizResult.result.length) {
                        clearInterval(interval);
                    }
                    else if ((Number.parseInt(LiveQuizResult.result[VideoListCount].duration) - Number.parseInt(LVideo.currentTime)) < 1) {
                        VideoListCount = VideoListCount + 1;
                        VideoRender(VideoListCount);
                    }

                    if (Number.parseInt(LVideo.currentTime) == LiveQuizResult.result[VideoListCount].quesAppearingSec) {

                        ShowingOptionsWithModal(LiveQuizResult.result[VideoListCount]);
                    }


                }, 1000);
                

            //$.get(window.location.origin + "/landingpage/GettingLiveQuizInformationV3", function (res) {
                
            //    console.log(res);
            //    LiveQuizResult = res;

            //    CraeteDynamicVideoElement(LiveQuizResult);

            //    if (res.result != false) {

            //        var ScheduledTime = res.result[0].scheduledDateTime.split("T")[1].trim().split(":");

            //        var date = new Date();
            //        var seconds = date.getSeconds();
            //        var minutes = date.getMinutes();
            //        var hour = date.getHours();

            //        if (ScheduledTime[0] == hour && ScheduledTime[1] == minutes) {

            //            var video = document.getElementById('LVideo0');
            //            var source = document.getElementById('LSourceId');


            //            video.play();
            //            video.style.display = "block";

            //            if (ScheduledTime[2] <= seconds) {
            //                var SD = new Date(res.result[0].scheduledDateTime)
            //                var dateDiff = (date - SD) / 1000;
            //                console.log(dateDiff);

            //                if (video.duration > dateDiff) {
            //                    video.currentTime = dateDiff;
            //                } else {
            //                    video.currentTime = 3;
            //                }

            //            }

            //        } else {

            //            //////////////
            //            var video = document.getElementById('LVideo0');
            //            var source = document.getElementById('LSourceId');


            //            video.play();
            //            video.style.display = "block";


            //            if (ScheduledTime[2] <= seconds) {
            //                var SD = new Date(res.result[0].scheduledDateTime)
            //                var dateDiff = (date - SD) / 1000;
            //                console.log(dateDiff);

            //                if (video.duration > dateDiff) {
            //                    video.currentTime = dateDiff;
            //                } else {
            //                    video.currentTime = 3;
            //                }
            //            }
            //            //////////////////////
            //        }
            //        console.log(hour + ":" + minutes + ":" + seconds);
            //    }



                
            //    let interval = setInterval(function () {

            //        var LVideo = document.getElementById('LVideo');

                    
            //        if (VideoListCount > LiveQuizResult.result.length) {
            //            clearInterval(interval);
            //        }
            //        else if ((Number.parseInt(LiveQuizResult.result[VideoListCount].duration) - Number.parseInt(LVideo.currentTime)) < 1) {
            //            VideoListCount = VideoListCount + 1;
            //            VideoRender(VideoListCount);
            //        }
                    
            //        if (Number.parseInt(LVideo.currentTime) == LiveQuizResult.result[VideoListCount].quesAppearingSec) {

            //            ShowingOptionsWithModal(LiveQuizResult.result[VideoListCount]);
            //        }


            //    }, 1000);





            });


        });


        function VideoRender(VideoListCount) {

            //var VideoId = 'LVideo' + VideoListCount;

            //var video = document.getElementById(VideoId);

            //video.play();
            //video.style.display = "block";

            var video = document.getElementById('LVideo');
            var source = document.getElementById('LSourceId');

            source.setAttribute('src', LiveQuizResult.result[VideoListCount].videoName);
            video.preload = 'metadata';
            video.playsInline = true;
            video.autoplay = true;
            video.load();


            
        }

        function SubmitAnswerOfLiveQuiz() {
            var QuestionId = $("#RadioQuizId").val();
            var optionId = $("#RadioQuizOptionId").val();

            OptionDissapearFunction();

            $.get(JhotpotAnswerWithTimeBkashForSpecialQuiz + "?fbid=" + $.session.get('fbid') + "&qid=" + QuestionId + "&answer=" + optionId + "&timetaken=" + TimeTaken + "&ServiceName=QuizMaster&ServiceType=LiveQuizVideo", function (res) {

            });

            TimeTaken = 0;

        }


        function UnmuteVideo() {
            var video = document.getElementById('LVideo');
            video.muted = false;
            $("#unmuteButton").hide();
        }

        function ShowingOptionsWithModal(LiveQuizQuestion) {

            $("#RadioQuizId").val(LiveQuizQuestion.questionId);

            $("#optipon1label").text(LiveQuizQuestion.option1);
            $("#optipon2label").text(LiveQuizQuestion.option2);
            $("#optipon3label").text(LiveQuizQuestion.option3);
            $("#OptionAppearingTimerId").text(LiveQuizQuestion.optionShowingDurationSec);

            $("#QuestionOptions").slideDown("slow");

            var x = 0;
            let Optionsinterval = setInterval(function () {

                if (++x == LiveQuizQuestion.optionShowingDurationSec) {
                    TimeTaken = 0;
                    clearInterval(Optionsinterval);
                    OptionDissapearFunction();
                }
                var timerVal = $("#OptionAppearingTimerId").text()
                $("#OptionAppearingTimerId").text(Number.parseInt(timerVal) - 1);

                TimeTaken = TimeTaken + 1;

            }, 1000);

            //setTimeout(function () {

            //    OptionDissapearFunction();

            //}, LiveQuizQuestion.optionShowingDurationSec * 1000); //


        }

        function OptionSelection(opt) {
            $("#RadioQuizOptionId").val(opt);
            //var QuestionId = $("#RadioQuizId").val();

            //OptionDissapearFunction();

            //$.get(JhotpotAnswerWithTimeBkashForSpecialQuiz + "?fbid=" + $.session.get('fbid') + "&qid=" + QuestionId + "&answer=" + opt + "&timetaken=" + TimeTaken + "&ServiceName=QuizMaster&ServiceType=LiveQuizVideo", function (res) {

            //});
            //TimeTaken = 0;
        }

        function OptionDissapearFunction() {
            $("#QuestionOptions").hide(); //Hide options window
            //$("#QuestionOptions").slideUp(""); //Hide options window

            $("#RadioQuizOptionId").val("");
            $("#RadioQuizId").val("");
            $("#optipon1label").text("");
            $("#optipon2label").text("");
            $("#optipon3label").text("");

            $("input:radio").attr("checked", false);
        }

        function CraeteDynamicVideoElement(LiveQuizResult) {


            for (var i = 0; i < LiveQuizResult.result.length; i++) {


                var video = document.createElement('video');

                video.id = "LVideo" + i;

                video.src = LiveQuizResult.result[i].videoName;

                //video.poster =
                //    'https://peach.blender.org/wp-content/uploads/title_anouncement.jpg?x11217';

                video.autoplay = true;
                video.controls = false;
                video.muted = true;
                video.load();
                video.pause();
                //video.height = 240; // 👈️ in px
                //video.width = 320; // 👈️ in px

                //style = "width: 100%; height: 90%; position: absolute; z-index: -1; background-color: black;"

                video.style.width = "100%";
                video.style.height = "90%";
                video.style.display = "none";
                video.style.position = "absolute";
                video.style["background-color"] = "black";
                video.style["z-index"] = "-1";

                

                var box = document.getElementById('LiveVideoDiv');

                box.appendChild(video);



            }

            
        }



    </script>

}


